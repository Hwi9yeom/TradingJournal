<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>계좌 관리 - Trading Journal</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">

    <!-- Styles -->
    <link rel="stylesheet" href="css/dashboard-glass.css">
</head>
<body>
    <!-- Background Orbs -->
    <div class="bg-orb bg-orb-1"></div>
    <div class="bg-orb bg-orb-2"></div>
    <div class="bg-orb bg-orb-3"></div>

    <!-- Navigation -->
    <div id="glass-nav"></div>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Page Header -->
        <header class="page-header fade-in">
            <div class="page-title">
                <h1>Account Management</h1>
                <span class="subtitle">계좌별 포트폴리오 관리</span>
            </div>
        </header>

        <!-- Stats Cards -->
        <section class="stats-grid">
            <div class="stat-card fade-in stagger-1">
                <div class="stat-card-header">
                    <span class="stat-card-label">전체 계좌</span>
                    <div class="stat-card-icon">
                        <i class="bi bi-wallet2"></i>
                    </div>
                </div>
                <div class="stat-card-value" id="total-accounts">0</div>
                <div class="stat-card-change">
                    <i class="bi bi-folder"></i>
                    관리중인 계좌
                </div>
            </div>
            <div class="stat-card fade-in stagger-2">
                <div class="stat-card-header">
                    <span class="stat-card-label">총 투자금액</span>
                    <div class="stat-card-icon">
                        <i class="bi bi-cash-stack"></i>
                    </div>
                </div>
                <div class="stat-card-value" id="total-investment">₩0</div>
                <div class="stat-card-change">
                    <i class="bi bi-arrow-down-up"></i>
                    투자 원금
                </div>
            </div>
            <div class="stat-card fade-in stagger-3">
                <div class="stat-card-header">
                    <span class="stat-card-label">총 평가금액</span>
                    <div class="stat-card-icon">
                        <i class="bi bi-graph-up-arrow"></i>
                    </div>
                </div>
                <div class="stat-card-value" id="total-value">₩0</div>
                <div class="stat-card-change">
                    <i class="bi bi-bar-chart"></i>
                    현재 가치
                </div>
            </div>
            <div class="stat-card fade-in stagger-4" id="profit-rate-card">
                <div class="stat-card-header">
                    <span class="stat-card-label">총 수익률</span>
                    <div class="stat-card-icon">
                        <i class="bi bi-percent"></i>
                    </div>
                </div>
                <div class="stat-card-value" id="total-profit-rate">0%</div>
                <div class="stat-card-change">
                    <i class="bi bi-graph-up"></i>
                    전체 수익
                </div>
            </div>
        </section>

        <!-- 계좌 추가 폼 -->
        <section class="glass-card mb-8 fade-in">
            <div class="glass-card-header">
                <h3><i class="bi bi-plus-circle"></i> 계좌 추가</h3>
            </div>
            <div class="glass-card-body">
                <form id="account-form">
                    <div style="display: grid; grid-template-columns: 1fr 1fr 2fr auto; gap: var(--space-4); align-items: end;">
                        <div class="form-group" style="margin-bottom: 0;">
                            <label class="form-label">계좌명</label>
                            <input type="text" class="form-input" id="account-name" placeholder="예: ISA계좌" required>
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label class="form-label">계좌 유형</label>
                            <select class="select-glass" id="account-type" required>
                                <option value="GENERAL">일반 계좌</option>
                                <option value="ISA">ISA 계좌</option>
                                <option value="PENSION">연금 계좌</option>
                                <option value="CUSTOM">사용자 정의</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label class="form-label">설명</label>
                            <input type="text" class="form-input" id="account-description" placeholder="계좌에 대한 설명 (선택)">
                        </div>
                        <div>
                            <button type="submit" class="btn-glass primary">
                                <i class="bi bi-plus-lg"></i>
                                추가
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </section>

        <!-- 계좌 목록 -->
        <section class="glass-card mb-8 fade-in">
            <div class="glass-card-header">
                <h3><i class="bi bi-list-ul"></i> 계좌 목록</h3>
            </div>
            <div class="glass-card-body" style="padding: 0;">
                <table class="glass-table">
                    <thead>
                        <tr>
                            <th>계좌명</th>
                            <th>유형</th>
                            <th>설명</th>
                            <th class="text-right">투자금액</th>
                            <th class="text-right">평가금액</th>
                            <th class="text-right">수익률</th>
                            <th>기본계좌</th>
                            <th>작업</th>
                        </tr>
                    </thead>
                    <tbody id="account-list">
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 계좌별 포트폴리오 현황 -->
        <section class="glass-card fade-in">
            <div class="glass-card-header">
                <h3><i class="bi bi-pie-chart"></i> 계좌별 포트폴리오 현황</h3>
            </div>
            <div class="glass-card-body">
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: var(--space-6);" id="account-portfolios">
                    <!-- 동적으로 생성됨 -->
                </div>
            </div>
        </section>
    </main>

    <!-- 계좌 수정 모달 -->
    <div class="modal-glass" id="editAccountModal">
        <div class="modal-glass-content">
            <div class="modal-header">
                <h3><i class="bi bi-pencil-square"></i> 계좌 수정</h3>
                <button class="modal-close" onclick="closeEditModal()">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="edit-account-id">
                <div class="form-group">
                    <label class="form-label">계좌명</label>
                    <input type="text" class="form-input" id="edit-account-name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">계좌 유형</label>
                    <select class="select-glass" id="edit-account-type" required>
                        <option value="GENERAL">일반 계좌</option>
                        <option value="ISA">ISA 계좌</option>
                        <option value="PENSION">연금 계좌</option>
                        <option value="CUSTOM">사용자 정의</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">설명</label>
                    <input type="text" class="form-input" id="edit-account-description">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-glass" onclick="closeEditModal()">취소</button>
                <button class="btn-glass primary" onclick="updateAccount()">
                    <i class="bi bi-check-lg"></i>
                    저장
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="utils.js"></script>
    <script src="auth.js"></script>
    <script src="js/navigation-glass.js"></script>
    <script src="js/glass-utils.js"></script>
    <script src="js/theme-toggle.js"></script>
    <script src="accounts.js"></script>
    <script>
        // Initialize Glass Navigation
        document.addEventListener('DOMContentLoaded', function() {
            const nav = new GlassNavigation('glass-nav', 'accounts.html');
        });

        // Close edit modal helper
        function closeEditModal() {
            const modal = document.getElementById('editAccountModal');
            modal.classList.remove('show');
        }

        // Open edit modal helper
        function openEditModal() {
            const modal = document.getElementById('editAccountModal');
            modal.classList.add('show');
        }
    </script>
</body>
</html>
